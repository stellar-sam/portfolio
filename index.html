<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sambhav Jain | Portfolio</title>
    <!-- Helm Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%237c3aed' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='12' cy='12' r='4'/%3E%3Ccircle cx='12' cy='12' r='7'/%3E%3Cline x1='12' y1='1' x2='12' y2='5'/%3E%3Cline x1='12' y1='19' x2='12' y2='23'/%3E%3Cline x1='1' y1='12' x2='5' y2='12'/%3E%3Cline x1='19' y1='12' x2='23' y2='12'/%3E%3Cline x1='4.22' y1='4.22' x2='7.05' y2='7.05'/%3E%3Cline x1='16.95' y1='16.95' x2='19.78' y2='19.78'/%3E%3Cline x1='4.22' y1='19.78' x2='7.05' y2='16.95'/%3E%3Cline x1='16.95' y1='7.05' x2='19.78' y2='4.22'/%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --space-black: #020617;
            --luxury-purple: #7c3aed;
            --royal-indigo: #1e1b4b;
            --gold-accent: #fbbf24;
            --star-white: #fafaf9;
            --nebula-soft: rgba(124, 58, 237, 0.1);
        }

        body {
            background-color: var(--space-black);
            color: #f8fafc;
            font-family: 'Optima', 'Segoe UI', Tahoma, sans-serif;
            scroll-behavior: smooth;
            overflow-x: hidden;
            margin: 0;
        }

        /* Subtle Purple Nebula Accents */
        .nebula-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 10% 10%, rgba(124, 58, 237, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 90% 90%, rgba(30, 27, 75, 0.2) 0%, transparent 50%);
            z-index: -2;
        }

        #star-canvas {
            position: fixed;
            top: 0; left: 0;
            z-index: -1;
            pointer-events: none;
        }

        .luxury-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(124, 58, 237, 0.2);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
        }

        .project-card {
            border: 1px solid rgba(124, 58, 237, 0.1);
            background: rgba(30, 41, 59, 0.3);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            overflow: hidden; 
        }

        .project-card:hover {
            border-color: var(--luxury-purple);
            box-shadow: 0 0 30px rgba(124, 58, 237, 0.15);
            transform: translateY(-8px);
        }

        .media-container {
            width: 100%;
            aspect-ratio: 16 / 10;
            background: #080c14;
            margin-bottom: 1.5rem;
            border-radius: 1rem;
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: zoom-in;
            user-select: none;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .media-container:active { cursor: grabbing; }

        .media-container img, .media-container video {
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            transition: transform 0.4s ease, opacity 0.4s ease;
            pointer-events: none;
        }

        #game-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: black;
            z-index: 1000;
        }

        #scroll-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(15px);
            z-index: 1002;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .ancient-scroll {
            background: #fdf6e3;
            color: #2c241a;
            padding: 3rem;
            max-width: 600px;
            width: 100%;
            border-radius: 4px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5), inset 0 0 100px rgba(0,0,0,0.1);
            position: relative;
            font-family: 'Times New Roman', serif;
            border-left: 15px solid #8b4513;
            border-right: 15px solid #8b4513;
            transform: rotate(-0.5deg);
            max-height: 80vh;
            overflow-y: auto;
        }

        .ancient-scroll h2 {
            font-size: 1.5rem;
            text-align: center;
            border-bottom: 1px double #8b4513;
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
        }

        .ancient-scroll p {
            line-height: 1.8;
            font-size: 1.1rem;
        }

        .easter-egg-trigger { cursor: pointer; transition: all 0.3s; }
        .easter-egg-trigger:hover { color: var(--luxury-purple); filter: drop-shadow(0 0 8px var(--luxury-purple)); }

        .category-tag {
            font-size: 0.65rem;
            padding: 2px 12px;
            background: rgba(124, 58, 237, 0.1);
            color: var(--luxury-purple);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 99px;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-2px); }
            75% { transform: translateX(2px); }
        }
        .locked-warp { color: #ef4444 !important; animation: shake 0.2s infinite; }

        #footer-warp-icon svg {
            width: 48px;
            height: 48px;
            stroke: currentColor;
            fill: none;
            stroke-width: 1.5;
            transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #footer-warp-icon:hover svg { transform: rotate(45deg); }

        .gate-box {
            padding: 4px 10px;
            background: rgba(16, 185, 129, 0.05);
            border: 1px solid rgba(16, 185, 129, 0.2);
            border-radius: 4px;
            font-size: 9px;
            color: #10b981;
            text-transform: uppercase;
            min-width: 60px;
            text-align: center;
        }

        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: var(--space-black); }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
        
        .game-ui {
            position: absolute;
            top: 2rem;
            left: 2rem;
            pointer-events: none;
            z-index: 1001;
            font-family: monospace;
        }

        #alert-msg {
            position: absolute;
            bottom: 25%;
            left: 50%;
            transform: translateX(-50%);
            color: #fbbf24;
            font-weight: bold;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            font-size: 1.2rem;
            display: none;
            animation: pulse 1s infinite;
            pointer-events: none;
            text-shadow: 0 0 15px #fbbf24;
        }
        @keyframes pulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }

        .game-over-modal {
            display: none;
            position: fixed;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(2, 6, 23, 0.95);
            border: 1px solid #ef4444;
            padding: 2rem;
            border-radius: 1rem;
            z-index: 1005;
            text-align: center;
        }

        #pointer-notice {
            position: absolute;
            bottom: 2rem;
            right: 2rem;
            color: rgba(255,255,255,0.3);
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            z-index: 1001;
        }
    </style>
</head>
<body>

    <canvas id="star-canvas"></canvas>
    <div class="nebula-bg"></div>

    <div id="game-overlay">
        <div class="game-ui flex flex-col gap-2">
            <div class="text-violet-400 text-lg tracking-widest uppercase" id="voyage-status">ESTABLISHING WARP...</div>
            <div class="flex items-center gap-4">
                <div class="text-[10px] text-white/50">HULL INTEGRITY:</div>
                <div class="w-32 h-1 bg-white/10 rounded-full overflow-hidden">
                    <div id="hull-bar" class="h-full bg-emerald-500 transition-all duration-300 w-full"></div>
                </div>
            </div>
            <div class="text-[10px] text-white/50 uppercase tracking-tighter">
                DEBRIS NEUTRALIZED: <span id="kill-counter" class="text-violet-400">0</span>
            </div>
            <div class="text-[10px] text-white/50">DISTANCE: <span id="dist-counter" class="text-white">0</span> LY</div>
            <div class="text-[10px] text-white/40 mt-4">ESC: EXIT • [SPACE]: FIRE LASER • [W]: WARP • CLICK: BOOST</div>
        </div>
        <div id="pointer-notice">Click to lock mouse</div>
        <div id="alert-msg">PLANET APPROACHING - PRESS [W] TO WARP</div>
        <canvas id="game-canvas"></canvas>
    </div>

    <div id="game-over" class="game-over-modal">
        <h2 class="text-3xl text-red-500 font-bold mb-4 uppercase tracking-widest">Voyage Failed</h2>
        <p class="text-white/60 mb-6 text-sm">Your ship was destroyed by cosmic debris.</p>
        <button onclick="location.reload()" class="bg-red-500/20 border border-red-500 text-red-500 px-8 py-2 text-xs uppercase tracking-widest hover:bg-red-500 hover:text-white transition">Try Again</button>
    </div>

    <!-- Scroll Overlay -->
    <div id="scroll-overlay">
        <div class="ancient-scroll">
            <div class="text-[10px] text-amber-900/60 mb-2 uppercase tracking-widest font-bold">Scientific Archive Unlocked</div>
            <h2 id="scroll-title">Subject: Physics</h2>
            <div id="scroll-loading" class="text-center py-8">
                <div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-amber-900"></div>
            </div>
            <p id="scroll-body" class="mb-6"></p>
            <div class="mt-8 pt-4 border-t border-amber-900/10 text-center">
                <span class="bg-amber-900/10 text-amber-900 px-3 py-1 rounded text-[10px] font-bold uppercase tracking-widest animate-pulse">Press [X] to Close</span>
            </div>
        </div>
    </div>

    <header class="relative pt-24 pb-16 px-6">
        <div class="max-w-6xl mx-auto relative z-10">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-8">
                <div>
                    <h1 class="text-6xl md:text-8xl font-light tracking-tighter mb-4 text-white">
                        Sambhav <span class="text-violet-500">Jain</span>
                    </h1>
                </div>
                
                <div class="luxury-panel p-6 rounded-xl text-xs tracking-widest space-y-3 min-w-[280px]">
                    <div class="text-violet-400/50 uppercase border-b border-white/10 pb-2 mb-3">Communications</div>
                    <div class="grid grid-cols-2 gap-x-6 gap-y-2">
                        <span class="text-white/40">MAIL:</span> <a href="mailto:js.jain.sam@gmail.com" target="_blank" rel="noopener noreferrer" class="text-white hover:text-violet-400 transition">Email</a>
                        <span class="text-white/40">LINKEDIN:</span> <a href="https://linkedin.com/in/sambhav-jain-cos" target="_blank" rel="noopener noreferrer" class="text-white hover:text-violet-400 transition">Profile</a>
                        <span class="text-white/40">GITHUB:</span> <a href="https://github.com/stellar-sam" target="_blank" rel="noopener noreferrer" class="text-white hover:text-violet-400 transition">stellar-sam</a>
                        <span class="text-white/40">DISCORD:</span> <span class="text-white">legend_sam</span>
                        <span class="text-white/40">STATUS:</span> <span id="status-trigger" onclick="toggleLogicGate()" class="easter-egg-trigger text-emerald-400">[NOMINAL]</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Logic Gate Easter Egg -->
        <div id="logic-egg" class="hidden max-w-6xl mx-auto mt-12 luxury-panel p-8 rounded-2xl border-emerald-500/20">
            <div class="flex flex-col gap-6">
                <div class="flex justify-between items-center border-b border-emerald-500/10 pb-4">
                    <div class="flex flex-col">
                        <span class="text-xs text-emerald-500 tracking-[0.3em] font-light uppercase">System Ignition Circuit</span>
                        <span id="egg-msg" class="text-[10px] text-emerald-600 tracking-widest uppercase mt-1">Status: Encrypted</span>
                    </div>
                </div>
                
                <div class="flex flex-wrap items-center justify-center gap-4 md:gap-8 py-4">
                    <div class="flex flex-col gap-3">
                        <button onclick="eggSwitch(0)" id="sw0" class="border border-emerald-500/30 px-6 py-2 text-[10px] rounded-md hover:bg-emerald-500/10 transition-all uppercase tracking-widest">In_A: 0</button>
                        <button onclick="eggSwitch(1)" id="sw1" class="border border-emerald-500/30 px-6 py-2 text-[10px] rounded-md hover:bg-emerald-500/10 transition-all uppercase tracking-widest">In_B: 0</button>
                        <button onclick="eggSwitch(2)" id="sw2" class="border border-emerald-500/30 px-6 py-2 text-[10px] rounded-md hover:bg-emerald-500/10 transition-all uppercase tracking-widest">In_C: 0</button>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-[1px] bg-emerald-500/30"></div>
                        <div id="gate-1-ui" class="gate-box">---</div>
                        <div class="w-8 h-[1px] bg-emerald-500/30"></div>
                        <div id="gate-2-ui" class="gate-box">---</div>
                        <div class="w-8 h-[1px] bg-emerald-500/30"></div>
                        <div id="gate-3-ui" class="gate-box">---</div>
                        <div class="w-8 h-[1px] bg-emerald-500/30"></div>
                    </div>
                    <div class="flex flex-col items-center gap-2">
                        <div id="egg-led" class="w-6 h-6 rounded-full bg-emerald-950 border border-emerald-500/50 shadow-inner transition-all duration-300"></div>
                        <span class="text-[9px] text-emerald-500/50 uppercase">Ignition</span>
                    </div>
                </div>
                <div class="text-center"><p id="logic-formula" class="text-[9px] text-white/20 italic font-mono"></p></div>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto py-12 px-6">
        <section>
            <div class="flex items-center gap-6 mb-16">
                <h2 class="text-3xl font-light tracking-[0.4em] text-white uppercase">Portfolio</h2>
                <div class="h-[1px] flex-1 bg-gradient-to-r from-violet-500/30 to-transparent"></div>
            </div>
            <div id="project-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-10"></div>
        </section>
    </main>

    <footer class="mt-32 py-20 border-t border-white/5 text-center">
        <div class="max-w-6xl mx-auto px-6 flex flex-col items-center">
            <div id="footer-warp-icon" onclick="attemptWarp()" class="easter-egg-trigger text-white/10 mb-8 transition-all duration-700" title="Warp Drive: Locked">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="4" /><circle cx="12" cy="12" r="7" />
                    <line x1="12" y1="1" x2="12" y2="5" /><line x1="12" y1="19" x2="12" y2="23" />
                    <line x1="1" y1="12" x2="5" y2="12" /><line x1="19" y1="12" x2="23" y2="12" />
                    <line x1="4.22" y1="4.22" x2="7.05" y2="7.05" /><line x1="16.95" y1="16.95" x2="19.78" y2="19.78" />
                    <line x1="4.22" y1="19.78" x2="7.05" y2="16.95" /><line x1="16.95" y1="7.05" x2="19.78" y2="4.22" />
                </svg>
            </div>
            <p class="text-white/20 text-xs tracking-[0.5em] uppercase mb-2">Sambhav Jain // Earth // 2026</p>
        </div>
    </footer>

    <script>
        const apiKey = "";
        const projects = [
            {
                name: "Health Monitoring using AI & Sensors",
                description: "Wearable device to monitor health using embedded sensors and AI NLP models.",
                type: "Electronics",
                date: "Sept 2025",
                image: ["assets/health-ai-1.jpg", "assets/health-ai-2.jpg"], 
                links: []
            },
            {
                name: "2D Game",
                description: "Work In Progress project exploring procedural 2D mechanics.",
                type: "Game Development",
                date: "Nov 2024 - Present",
                image: "assets/wip-game.jpg", 
                links: []
            },
            {
                name: "Vesmir: Tools and Ores",
                description: "Minecraft mod adding custom planetary resources and high-tier equipment.",
                type: "Game Development",
                date: "2024",
                image: ["assets/vesmir.jpg"],
                links: [
                    { label: "CurseForge", url: "https://www.curseforge.com/minecraft/mc-mods/vesmir-tools-and-ores" },
                    { label: "Modrinth", url: "https://modrinth.com/mod/vesmir-tools-and-ores" }
                ]
            },
            {
                name: "AI Spritesheet Generator",
                description: "Fine-tuned Stable Diffusion GAN for generating game-ready spritesheets.",
                type: "Deep Learning",
                date: "Dec 2022 - Present",
                image: ["assets/spritesheet-ai-1.jpg", "assets/spritesheet-ai-2.jpg"],
                links: [
                    { label: "Huggingface", url: "https://huggingface.co/datasets/legend-sam/pokemon-sprite-sheet-dataset" },
                    { label: "GitHub", url: "https://github.com/stellar-sam/pokemon-sprite-sheet-dataset" }
                ]
            },
            {
                name: "Roblox Game Portfolio",
                description: "Collection of titles including 'The Burger Who Tried To Escape' and various Obbys.",
                type: "Game Development",
                date: "2022 - 2023",
                image: ["assets/roblox1.jpg", "assets/roblox2.jpg", "assets/roblox3.jpg", "assets/roblox4.jpg", "assets/roblox5.jpg", "assets/roblox6.jpg"],
                links: [
                    { label: "Burger Escape", url: "https://www.roblox.com/games/16075139526/The-Burger-Who-Tried-To-Escape" },
                    { label: "Racing Obby", url: "https://www.roblox.com/games/8439734884" },
                    { label: "SpaceWar Obby", url: "https://www.roblox.com/games/15232449672" },
                    { label: "Player's Unknown BattleSky", url: "https://www.roblox.com/games/15458080547" }
                ]
            },
            {
                name: "E-Cricket",
                description: "Text-based sports simulator logic built in Python.",
                type: "Game Development",
                date: "2023",
                image: ["assets/e-cricket.jpg"],
                links: [{ label: "GitHub", url: "https://github.com/stellar-sam/e-cricket" }]
            },
            {
                name: "3D Visuals: Laptop, Sword & Black Hole",
                description: "Blender renders exploring hard-surface modeling and cosmic physics visualization.",
                type: "3D Animation",
                date: "2023",
                video: ["assets/black-hole.mp4", "assets/laptop.mp4", "assets/sword.mp4"],
                links: []
            },
            {
                name: "Vesmir: Weapons",
                description: "A minecraft mod that adds various swords in Minecraft.",
                type: "Game Development",
                date: "2024",
                image: ["assets/vesmirw.jpg"],
                links: [
                    { label: "CurseForge", url: "https://www.curseforge.com/minecraft/mc-mods/vesmir-weapons" },
                    { label: "Modrinth", url: "https://modrinth.com/mod/vesmir-weapons" }
                ]
            },
            {
                name: "Web Dev Portfolio",
                description: "Website designed and built with HTML, CSS, and JavaScript.",
                type: "Web Development",
                date: "2021 - Present",
                image: ["assets/webdev1.jpg"],
                links: [
                    { label: "School Club Website Design", url: "https://sambhavjainsj7.wixsite.com/byteit" }                ]
            },
        ];

        function render() {
            const grid = document.getElementById('project-grid');
            grid.innerHTML = projects.map((p, pIdx) => {
                let mediaHtml = '';
                const images = Array.isArray(p.image) ? p.image : (p.image ? [p.image] : []);
                const videos = Array.isArray(p.video) ? p.video : (p.video ? [p.video] : []);
                
                if (videos.length > 0) {
                    mediaHtml = `<div class="media-container"><video src="${videos[0]}" loop muted playsinline onmouseenter="this.play()" onmouseleave="this.pause()"></video></div>`;
                } else if (images.length > 0) {
                    mediaHtml = `<div class="media-container"><img src="${images[0]}" alt="${p.name}" loading="lazy"></div>`;
                }

                return `<div class="project-card p-8 rounded-3xl flex flex-col h-full">
                    ${mediaHtml}
                    <div class="flex justify-between items-center mb-4"><span class="category-tag">${p.type}</span><span class="text-[10px] text-white/30 tracking-widest">${p.date}</span></div>
                    <h3 class="text-2xl font-light text-white mb-4 tracking-tight">${p.name}</h3>
                    <p class="text-sm text-white/50 mb-8 leading-relaxed font-light flex-grow">${p.description}</p>
                    <div class="flex flex-wrap gap-4 mt-auto">${(p.links || []).map(l => `<a href="${l.url}" target="_blank" rel="noopener noreferrer" class="text-[9px] uppercase tracking-widest text-violet-400 hover:text-white border-b border-violet-400/20 hover:border-white transition-all">${l.label}</a>`).join('')}</div>
                </div>`;
            }).join('');
        }

        // --- GEMINI KNOWLEDGE SYSTEM ---
        async function fetchAncientKnowledge() {
            const fields = ["Quantum Physics", "Organic Chemistry", "Evolutionary Biology", "History of Civilizations", "Modern Technology", "Classical Literature", "Discrete Mathematics"];
            const selectedField = fields[Math.floor(Math.random() * fields.length)];
            
            const prompt = `Write an educational summary about ${selectedField}. 
            Format: Title: [Topic Name] followed by a 3-paragraph factual explanation. 
            Tone: Academic but accessible. No poetry. Under 150 words total.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                });
                const data = await response.json();
                const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "Communication with the archives failed.";
                
                // Simple parsing for title and body
                const titleMatch = text.match(/Title:\s*(.*)/);
                const title = titleMatch ? titleMatch[1] : selectedField;
                const body = text.replace(/Title:.*\n?/, '').trim();

                document.getElementById('scroll-title').innerText = title;
                document.getElementById('scroll-body').innerText = body;
            } catch (err) {
                document.getElementById('scroll-body').innerText = "System error: Failed to retrieve data from the central archive.";
            } finally {
                document.getElementById('scroll-loading').style.display = 'none';
            }
        }

        function closeScroll() {
            document.getElementById('scroll-overlay').style.display = 'none';
            gamePaused = false;
            // Re-request pointer lock when returning to game
            gameCanvas.requestPointerLock();
        }

        // --- LOGIC GATE EASTER EGG ---
        const GATES = { AND: (a, b) => a && b, OR: (a, b) => a || b, XOR: (a, b) => a !== b };
        const gateNames = Object.keys(GATES);
        let activeGates = [], logicInputs = [false, false, false], warpReady = false;

        function randomizeGates() {
            activeGates = [gateNames[Math.floor(Math.random() * 3)], gateNames[Math.floor(Math.random() * 3)], gateNames[Math.floor(Math.random() * 3)]];
            document.getElementById('gate-1-ui').innerText = activeGates[0];
            document.getElementById('gate-2-ui').innerText = activeGates[1];
            document.getElementById('gate-3-ui').innerText = activeGates[2];
            document.getElementById('logic-formula').innerText = `Circuit: (A ${activeGates[0]} B) ${activeGates[1]} (B ${activeGates[2]} C)`;
            updateCircuit();
        }

        function eggSwitch(idx) {
            logicInputs[idx] = !logicInputs[idx];
            document.getElementById(`sw${idx}`).innerText = `In_${String.fromCharCode(65+idx)}: ${logicInputs[idx] ? '1' : '0'}`;
            updateCircuit();
        }

        function updateCircuit() {
            const n1 = GATES[activeGates[0]](logicInputs[0], logicInputs[1]);
            const n2 = GATES[activeGates[2]](logicInputs[1], logicInputs[2]);
            const res = GATES[activeGates[1]](n1, n2);
            const led = document.getElementById('egg-led');
            const footer = document.getElementById('footer-warp-icon');
            warpReady = res;
            led.style.backgroundColor = res ? '#10b981' : '';
            led.style.boxShadow = res ? '0 0 20px #10b981' : '';
            footer.classList.toggle('text-violet-400', res);
            footer.classList.toggle('text-white/10', !res);
        }

        function toggleLogicGate() { document.getElementById('logic-egg').classList.toggle('hidden'); randomizeGates(); }

        // --- VOID VOYAGER GAME ---
        const gameOverlay = document.getElementById('game-overlay');
        const gameCanvas = document.getElementById('game-canvas');
        const gctx = gameCanvas.getContext('2d');
        
        let gameActive = false, gamePaused = false;
        let gStars = [], gAsteroids = [], gPlanets = [], gLasers = [];
        let mX = 0, mY = 0, speed = 1, distance = 0, hull = 100, kills = 0;
        let manualWarpRequested = false, laserCooldown = 0;

        // Pointer Lock State Handling
        document.addEventListener('pointerlockchange', () => {
            if (document.pointerLockElement === gameCanvas) {
                document.getElementById('pointer-notice').style.display = 'none';
            } else {
                if (gameActive && !gamePaused) {
                    document.getElementById('pointer-notice').style.display = 'block';
                }
            }
        });

        function startVoyager() {
            gameActive = true; gamePaused = false; hull = 100; distance = 0; kills = 0;
            gameOverlay.style.display = 'block';
            document.getElementById('game-over').style.display = 'none';
            gameCanvas.width = window.innerWidth; gameCanvas.height = window.innerHeight;
            
            // Set initial mouse to center
            mX = gameCanvas.width / 2;
            mY = gameCanvas.height / 2;

            gStars = Array(400).fill().map(() => ({ x: (Math.random()-0.5)*gameCanvas.width*2, y: (Math.random()-0.5)*gameCanvas.height*2, z: Math.random()*gameCanvas.width }));
            gAsteroids = []; gPlanets = []; gLasers = [];
            document.getElementById('hull-bar').style.width = '100%';
            document.getElementById('hull-bar').className = "h-full bg-emerald-500 transition-all duration-300 w-full";
            document.getElementById('voyage-status').innerText = "VOYAGE ACTIVE";

            // Request initial lock
            gameCanvas.requestPointerLock();
            gameLoop();
        }

        function spawnAsteroid() {
            if (gAsteroids.length > 25) return;
            const isInFront = Math.random() < 0.4;
            const xRange = isInFront ? 200 : gameCanvas.width * 2;
            const yRange = isInFront ? 200 : gameCanvas.height * 2;
            
            gAsteroids.push({ 
                x: (Math.random()-0.5) * xRange, 
                y: (Math.random()-0.5) * yRange, 
                z: gameCanvas.width, 
                size: 20 + Math.random() * 40,
                hp: 1
            });
        }

        function fireLaser() {
            if (laserCooldown > 0) return;
            gLasers.push({ t: 10 });
            laserCooldown = 15;
            
            const cx = gameCanvas.width / 2, cy = gameCanvas.height / 2;
            gAsteroids.forEach(a => {
                const ax = (a.x - (mX-cx)*0.5) * (gameCanvas.width/a.z) + cx;
                const ay = (a.y - (mY-cy)*0.5) * (gameCanvas.width/a.z) + cy;
                const ar = (1-a.z/gameCanvas.width)*a.size;
                if (a.z > 0 && Math.abs(ax-cx) < ar * 1.5 && Math.abs(ay-cy) < ar * 1.5) {
                    a.hp = 0;
                    kills++;
                    document.getElementById('kill-counter').innerText = kills;
                }
            });
        }

        function spawnPlanet() {
            if (gPlanets.length > 0) return;
            gPlanets.push({ x: (Math.random()-0.5)*gameCanvas.width, y: (Math.random()-0.5)*gameCanvas.height, z: gameCanvas.width, size: 120, color: `hsl(${Math.random()*360}, 50%, 40%)` });
        }

        function gameLoop() {
            if (!gameActive) return;
            if (gamePaused) { requestAnimationFrame(gameLoop); return; }

            gctx.fillStyle = '#010409';
            gctx.fillRect(0, 0, gameCanvas.width, gameCanvas.height);
            const cx = gameCanvas.width / 2, cy = gameCanvas.height / 2;

            if (Math.random() < 0.12) spawnAsteroid();
            if (Math.random() < 0.003) spawnPlanet();
            if (laserCooldown > 0) laserCooldown--;

            distance += (speed * 0.015);
            document.getElementById('dist-counter').innerText = Math.floor(distance);

            // Draw Stars
            gStars.forEach(s => {
                s.z -= 6 * speed; if (s.z <= 0) s.z = gameCanvas.width;
                const sx = (s.x - (mX-cx)*0.2) * (gameCanvas.width/s.z) + cx;
                const sy = (s.y - (mY-cy)*0.2) * (gameCanvas.width/s.z) + cy;
                const r = (1-s.z/gameCanvas.width)*2.5;
                gctx.fillStyle = `rgba(167, 139, 250, ${1-s.z/gameCanvas.width})`;
                gctx.beginPath(); gctx.arc(sx, sy, r, 0, Math.PI*2); gctx.fill();
            });

            // Draw Lasers
            gLasers = gLasers.filter(l => {
                l.t--;
                gctx.strokeStyle = `rgba(124, 58, 237, ${l.t/10})`;
                gctx.lineWidth = 4;
                gctx.beginPath();
                gctx.moveTo(cx, cy + 100);
                gctx.lineTo(cx, cy);
                gctx.stroke();
                return l.t > 0;
            });

            // Draw Asteroids
            gAsteroids = gAsteroids.filter(a => {
                if (a.hp <= 0) return false;
                a.z -= 18 * speed;
                const ax = (a.x - (mX-cx)*0.5) * (gameCanvas.width/a.z) + cx;
                const ay = (a.y - (mY-cy)*0.5) * (gameCanvas.width/a.z) + cy;
                const ar = (1-a.z/gameCanvas.width)*a.size;

                if (ar > 0) {
                    gctx.fillStyle = '#4b5563';
                    gctx.beginPath(); 
                    gctx.rect(ax-ar/2, ay-ar/2, ar, ar); 
                    gctx.fill();
                    if (a.z < 250 && Math.abs(ax-cx) < ar * 0.8 && Math.abs(ay-cy) < ar * 0.8) {
                        hull -= 15;
                        document.getElementById('hull-bar').style.width = hull+'%';
                        if (hull < 40) document.getElementById('hull-bar').classList.replace('bg-emerald-500', 'bg-red-500');
                        if (hull <= 0) { 
                            gameActive = false; 
                            document.exitPointerLock();
                            document.getElementById('game-over').style.display = 'block';
                        }
                        return false;
                    }
                }
                return a.z > 0;
            });

            // Draw Planets
            let planetNear = false;
            gPlanets = gPlanets.filter(p => {
                p.z -= 7 * speed;
                const px = (p.x - (mX-cx)*0.5) * (gameCanvas.width/p.z) + cx;
                const py = (p.y - (mY-cy)*0.5) * (gameCanvas.width/p.z) + cy;
                const pr = (1-p.z/gameCanvas.width)*p.size;
                if (pr > 0) {
                    planetNear = true;
                    gctx.fillStyle = p.color; gctx.beginPath(); gctx.arc(px, py, pr, 0, Math.PI*2); gctx.fill();
                    if (p.z < 300 && ((Math.abs(px-cx) < pr && Math.abs(py-cy) < pr) || (manualWarpRequested && p.z < 800))) {
                        manualWarpRequested = false;
                        gamePaused = true; 
                        document.exitPointerLock();
                        document.getElementById('scroll-overlay').style.display='flex';
                        document.getElementById('scroll-loading').style.display='block'; 
                        fetchAncientKnowledge();
                        return false;
                    }
                }
                return p.z > 0;
            });

            document.getElementById('alert-msg').style.display = planetNear ? 'block' : 'none';
            if (!planetNear) manualWarpRequested = false;

            // HUD Crosshair
            gctx.strokeStyle = planetNear ? 'rgba(251, 191, 36, 0.9)' : 'rgba(255, 255, 255, 0.4)';
            gctx.beginPath();
            gctx.moveTo(cx - 30, cy); gctx.lineTo(cx - 10, cy);
            gctx.moveTo(cx + 10, cy); gctx.lineTo(cx + 30, cy);
            gctx.moveTo(cx, cy - 30); gctx.lineTo(cx, cy - 10);
            gctx.moveTo(cx, cy + 10); gctx.lineTo(cx, cy + 30);
            gctx.stroke();

            requestAnimationFrame(gameLoop);
        }

        function attemptWarp() { if (warpReady) startVoyager(); else { const i = document.getElementById('footer-warp-icon'); i.classList.add('locked-warp'); setTimeout(()=>i.classList.remove('locked-warp'), 500); } }

        window.onmousemove = e => {
            if (document.pointerLockElement === gameCanvas) {
                mX += e.movementX;
                mY += e.movementY;
                mX = Math.max(0, Math.min(gameCanvas.width, mX));
                mY = Math.max(0, Math.min(gameCanvas.height, mY));
            } else {
                mX = e.clientX;
                mY = e.clientY;
            }
        };

        window.onmousedown = () => {
            if (gameActive && document.pointerLockElement !== gameCanvas && !gamePaused) {
                gameCanvas.requestPointerLock();
            }
            speed = 6;
        };
        window.onmouseup = () => speed = 1;
        
        window.onkeydown = e => { 
            const key = e.key.toLowerCase();
            
            // Global Escape
            if (e.key === 'Escape') { 
                gameActive = false; 
                gameOverlay.style.display = 'none'; 
                document.exitPointerLock();
                if (gamePaused) closeScroll();
            } 

            // Scroll Control: Press X to close
            if (gamePaused && key === 'x') {
                closeScroll();
                return;
            }

            // Game Controls
            if (gameActive && !gamePaused) {
                if (key === 'w') manualWarpRequested = true;
                if (e.code === 'Space') { fireLaser(); e.preventDefault(); }
            }
        };

        window.onload = () => {
            render();
            const bgCanvas = document.getElementById('star-canvas');
            const bgCtx = bgCanvas.getContext('2d');
            let stars = [];
            function res() { bgCanvas.width = window.innerWidth; bgCanvas.height = window.innerHeight; stars = Array(200).fill().map(()=>({x:Math.random()*bgCanvas.width, y:Math.random()*bgCanvas.height, s:Math.random()*1.5, o:Math.random(), v:0.01})); }
            function draw() { bgCtx.clearRect(0,0,bgCanvas.width,bgCanvas.height); stars.forEach(s=>{ bgCtx.fillStyle=`rgba(255,255,255,${s.o})`; bgCtx.beginPath(); bgCtx.arc(s.x,s.y,s.s,0,Math.PI*2); bgCtx.fill(); s.o+=s.v; if(s.o>1||s.o<0)s.v=-s.v; }); requestAnimationFrame(draw); }
            res(); draw(); window.onresize = res;
        };
    </script>
</body>
</html>